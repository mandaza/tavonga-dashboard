(()=>{var e={};e.id=882,e.ids=[882],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7310:e=>{"use strict";e.exports=require("url")},3333:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>d,routeModule:()=>h,tree:()=>o});var a=s(7096),r=s(6132),i=s(7284),n=s.n(i),l=s(2564),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let o=["",{children:["reports",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9569)),"/Users/mandaza/Documents/Project/tavonga/web-app/app/reports/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,498)),"/Users/mandaza/Documents/Project/tavonga/web-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/mandaza/Documents/Project/tavonga/web-app/app/reports/page.tsx"],p="/reports/page",x={require:s,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/reports/page",pathname:"/reports",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},5599:(e,t,s)=>{Promise.resolve().then(s.bind(s,7443))},7443:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ReportsPage});var a=s(784),r=s(9885),i=s(6729),n=s(7194),l=s(5256),c=s(87),o=s(9551),d=s(9546),p=s(2029),x=s(5574),h=s(4409),m=s(2032),g=s(5441),u=s(696),j=s(9815),v=s(1672),b=s(3223),f=s(8699),y=s(2252),N=s(5905),w=s(4292),R=s(345);let MonthlyReportChart=({behaviors:e,activities:t,shifts:s})=>{let r=Array.from({length:6},(e,t)=>{let s=new Date;return s.setMonth(s.getMonth()-t),s.toISOString().slice(0,7)}).reverse(),i=r.map(t=>e.filter(e=>e.date?.startsWith(t)).length),n=r.map(e=>t.filter(t=>t.date?.startsWith(e)).length),c=r.map(e=>s.filter(t=>t.date?.startsWith(e)).length),o={labels:r.map(e=>new Date(e+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"})),datasets:[{label:"Behavior Reports",data:i,backgroundColor:"#FF6B6B",borderColor:"#FF5252",borderWidth:2,borderRadius:4},{label:"Activity Reports",data:n,backgroundColor:"#4ECDC4",borderColor:"#3DB9B2",borderWidth:2,borderRadius:4},{label:"Shift Reports",data:c,backgroundColor:"#45B7D1",borderColor:"#3A9BC7",borderWidth:2,borderRadius:4}]};return(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Monthly Report Generation"}),a.jsx(l.Z,{className:"w-5 h-5 text-nav-icon"})]}),a.jsx("div",{className:"h-64",children:a.jsx(b.$Q,{data:o,options:{...y.q_,plugins:{...y.q_.plugins,legend:{...y.q_.plugins.legend,position:"top",labels:{...y.q_.plugins.legend.labels,boxWidth:12,padding:15}}},scales:{x:{...y.q_.scales.x,grid:{display:!1}},y:{...y.q_.scales.y,beginAtZero:!0,ticks:{...y.q_.scales.y.ticks,stepSize:5}}}}})})]})},ReportCard=({title:e,description:t,icon:s,count:r,trend:i,onGenerate:n,isLoading:l=!1})=>(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-btn-primary rounded-lg flex items-center justify-center",children:a.jsx(s,{className:"w-5 h-5 text-white"})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-card-title",children:e}),a.jsx("p",{className:"text-sm text-card-subtext",children:t})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:"text-2xl font-bold text-card-title",children:r}),i&&a.jsx("p",{className:"text-sm text-text-positive",children:i})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:n,disabled:l,className:"btn-primary flex items-center gap-2 flex-1",children:[l?a.jsx(c.Z,{className:"w-4 h-4 animate-spin"}):a.jsx(o.Z,{className:"w-4 h-4"}),l?"Generating...":"Export CSV"]}),(0,a.jsxs)("button",{onClick:n,disabled:l,className:"btn-secondary flex items-center gap-2",children:[l?a.jsx(c.Z,{className:"w-4 h-4 animate-spin"}):a.jsx(d.Z,{className:"w-4 h-4"}),"PDF"]})]})]}),FilterPanel=({dateRange:e,setDateRange:t,selectedCarer:s,setSelectedCarer:r,selectedType:i,setSelectedType:n,users:l})=>(0,a.jsxs)("div",{className:"card p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-card-title mb-4",children:"Report Filters"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Date Range"}),(0,a.jsxs)("select",{value:e,onChange:e=>t(e.target.value),className:"input-field",children:[a.jsx("option",{value:"7d",children:"Last 7 days"}),a.jsx("option",{value:"30d",children:"Last 30 days"}),a.jsx("option",{value:"90d",children:"Last 90 days"}),a.jsx("option",{value:"custom",children:"Custom range"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Carer"}),(0,a.jsxs)("select",{value:s,onChange:e=>r(e.target.value),className:"input-field",children:[a.jsx("option",{value:"all",children:"All Carers"}),l.map(e=>a.jsx("option",{value:e.id,children:e.full_name},e.id))]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Report Type"}),(0,a.jsxs)("select",{value:i,onChange:e=>n(e.target.value),className:"input-field",children:[a.jsx("option",{value:"all",children:"All Types"}),a.jsx("option",{value:"behavior",children:"Behavior Reports"}),a.jsx("option",{value:"activity",children:"Activity Reports"}),a.jsx("option",{value:"shift",children:"Shift Reports"}),a.jsx("option",{value:"goal",children:"Goal Reports"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-6",children:[(0,a.jsxs)("button",{className:"btn-primary flex items-center gap-2",children:[a.jsx(p.Z,{className:"w-4 h-4"}),"Apply Filters"]}),a.jsx("button",{className:"btn-secondary",children:"Reset"})]})]}),RecentReports=()=>(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Recent Reports"}),(0,a.jsxs)("button",{className:"btn-secondary flex items-center gap-2",children:[a.jsx(x.Z,{className:"w-4 h-4"}),"Download All"]})]}),a.jsx("div",{className:"space-y-3",children:[{name:"Behavior Report - Jan 2024",type:"CSV",date:"2024-01-20",size:"2.3 MB"},{name:"Activity Completion Report",type:"PDF",date:"2024-01-19",size:"1.8 MB"},{name:"Shift Attendance Report",type:"CSV",date:"2024-01-18",size:"3.1 MB"},{name:"Goal Progress Report",type:"PDF",date:"2024-01-17",size:"2.7 MB"}].map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-bg-highlight rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:(0,f.cn)("w-8 h-8 rounded-lg flex items-center justify-center","CSV"===e.type?"bg-green-100":"bg-red-100"),children:"CSV"===e.type?a.jsx(o.Z,{className:"w-4 h-4 text-green-800"}):a.jsx(d.Z,{className:"w-4 h-4 text-red-800"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium text-card-title",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-card-subtext",children:[(0,f.p6)(e.date)," â€¢ ",e.size]})]})]}),a.jsx("button",{className:"p-2 text-nav-icon hover:bg-bg-primary rounded-lg transition-colors",children:a.jsx(x.Z,{className:"w-4 h-4"})})]},t))})]}),QuickStats=({behaviors:e,activities:t,shifts:s,goals:r})=>(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsx("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-card-subtext",children:"Total Behaviors"}),a.jsx("p",{className:"text-2xl font-bold text-card-title",children:e.length})]}),a.jsx("div",{className:"w-12 h-12 bg-btn-primary rounded-lg flex items-center justify-center",children:a.jsx(h.Z,{className:"w-6 h-6 text-white"})})]})}),a.jsx("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-card-subtext",children:"Completed Activities"}),a.jsx("p",{className:"text-2xl font-bold text-card-title",children:t.filter(e=>e.completed).length})]}),a.jsx("div",{className:"w-12 h-12 bg-text-positive/10 rounded-lg flex items-center justify-center",children:a.jsx(m.Z,{className:"w-6 h-6 text-text-positive"})})]})}),a.jsx("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-card-subtext",children:"Completed Shifts"}),a.jsx("p",{className:"text-2xl font-bold text-card-title",children:s.filter(e=>"completed"===e.status).length})]}),a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(g.Z,{className:"w-6 h-6 text-green-800"})})]})}),a.jsx("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-card-subtext",children:"Active Goals"}),a.jsx("p",{className:"text-2xl font-bold text-card-title",children:r.filter(e=>"active"===e.status).length})]}),a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(u.Z,{className:"w-6 h-6 text-blue-800"})})]})})]});function ReportsPage(){let{behaviors:e}=(0,N.SU)(),{activities:t}=(0,N.G$)(),{shifts:s}=(0,N.dE)(),{goals:c}=(0,N.g0)(),{users:o}=(0,N.UV)(),[p,x]=(0,r.useState)("7d"),[m,b]=(0,r.useState)("all"),[f,y]=(0,r.useState)("all"),[C,_]=(0,r.useState)(null),handleGenerateReport=async(e,t="csv")=>{_(`${e}-${t}`);try{let s,a;let r={format:t};if("all"!==p){let e=new Date,t=new Date;switch(p){case"7d":t.setDate(e.getDate()-7);break;case"30d":t.setDate(e.getDate()-30);break;case"90d":t.setDate(e.getDate()-90)}r.start=t.toISOString().split("T")[0],r.end=e.toISOString().split("T")[0]}switch("all"!==m&&(r.user=m,r.carer=m),e){case"behavior":s=await w.x.generateBehaviorReport(r),a=`behavior_report_${new Date().toISOString().split("T")[0]}.${t}`;break;case"activity":s=await w.x.generateActivityReport(r),a=`activity_report_${new Date().toISOString().split("T")[0]}.${t}`;break;case"shift":s=await w.x.generateShiftReport(r),a=`shift_report_${new Date().toISOString().split("T")[0]}.${t}`;break;case"goal":s=await w.x.generateGoalReport(r),a=`goal_report_${new Date().toISOString().split("T")[0]}.${t}`;break;case"carer":case"comprehensive":R.default.error(`${e.charAt(0).toUpperCase()+e.slice(1)} reports are coming soon!`);return;default:throw Error("Invalid report type")}let i=window.URL.createObjectURL(s),n=document.createElement("a");n.href=i,n.download=a,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(i),document.body.removeChild(n),R.default.success(`${e.charAt(0).toUpperCase()+e.slice(1)} report downloaded successfully!`)}catch(e){console.error("Error generating report:",e),R.default.error(e.message||"Failed to generate report")}finally{_(null)}},getReportCount=a=>{switch(a){case"behavior":return e.length;case"activity":return t.length;case"shift":return s.length;case"goal":return c.length;default:return 0}},getTrend=a=>{let r=new Date,i=new Date;i.setDate(r.getDate()-7);let n=0,l=0;switch(a){case"behavior":n=e.filter(e=>new Date(e.date)>=i).length,l=e.length;break;case"activity":n=t.filter(e=>new Date(e.date)>=i).length,l=t.length;break;case"shift":n=s.filter(e=>new Date(e.date)>=i).length,l=s.length;break;case"goal":n=c.filter(e=>new Date(e.created_at)>=i).length,l=c.length}if(0===l)return;let o=Math.round(n/l*100);return`+${n} this week (${o}%)`};return a.jsx(i.Z,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx(n.Z,{items:[{label:"Dashboard",href:"/dashboard"},{label:"Reports"}]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:"Reports & Analytics"}),a.jsx("p",{className:"text-text-secondary",children:"Generate and export comprehensive reports for care management"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("button",{className:"btn-secondary flex items-center gap-2",children:[a.jsx(l.Z,{className:"w-4 h-4"}),"View Analytics"]}),(0,a.jsxs)("button",{className:"btn-primary flex items-center gap-2",children:[a.jsx(d.Z,{className:"w-4 h-4"}),"Generate Report"]})]})]}),a.jsx(QuickStats,{behaviors:e,activities:t,shifts:s,goals:c}),a.jsx(FilterPanel,{dateRange:p,setDateRange:x,selectedCarer:m,setSelectedCarer:b,selectedType:f,setSelectedType:y,users:o}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.jsx(ReportCard,{title:"Behavior Reports",description:"Track behavior patterns and interventions",icon:h.Z,count:getReportCount("behavior"),trend:getTrend("behavior"),onGenerate:()=>handleGenerateReport("behavior"),isLoading:"behavior-csv"===C}),a.jsx(ReportCard,{title:"Activity Reports",description:"Monitor activity completion and progress",icon:j.Z,count:getReportCount("activity"),trend:getTrend("activity"),onGenerate:()=>handleGenerateReport("activity"),isLoading:"activity-csv"===C}),a.jsx(ReportCard,{title:"Shift Reports",description:"Track carer attendance and performance",icon:g.Z,count:getReportCount("shift"),trend:getTrend("shift"),onGenerate:()=>handleGenerateReport("shift"),isLoading:"shift-csv"===C}),a.jsx(ReportCard,{title:"Goal Reports",description:"Track goal achievement and milestones",icon:u.Z,count:getReportCount("goal"),trend:getTrend("goal"),onGenerate:()=>handleGenerateReport("goal"),isLoading:"goal-csv"===C}),a.jsx(ReportCard,{title:"Carer Reports",description:"Evaluate carer performance and engagement",icon:v.Z,count:o.length,trend:`${o.filter(e=>e.is_active_carer).length} active`,onGenerate:()=>handleGenerateReport("carer"),isLoading:"carer-csv"===C}),a.jsx(ReportCard,{title:"Comprehensive Report",description:"Complete overview of all metrics",icon:l.Z,count:1,onGenerate:()=>handleGenerateReport("comprehensive"),isLoading:"comprehensive-csv"===C})]}),a.jsx(RecentReports,{}),a.jsx(MonthlyReportChart,{behaviors:e,activities:t,shifts:s})]})})}},9569:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>c});var a=s(5153);let r=(0,a.createProxy)(String.raw`/Users/mandaza/Documents/Project/tavonga/web-app/app/reports/page.tsx`),{__esModule:i,$$typeof:n}=r,l=r.default,c=l}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[4312,9708,6897,3223,8282,1671,2234,3672,5905,2252],()=>__webpack_exec__(3333));module.exports=s})();