(()=>{var e={};e.id=6240,e.ids=[6240],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7310:e=>{"use strict";e.exports=require("url")},5864:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>c});var a=t(7096),l=t(6132),r=t(7284),n=t.n(r),i=t(2564),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);t.d(s,d);let c=["",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7498)),"/Users/mandaza/Documents/Project/tavonga/web-app/app/users/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,498)),"/Users/mandaza/Documents/Project/tavonga/web-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/mandaza/Documents/Project/tavonga/web-app/app/users/page.tsx"],m="/users/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/users/page",pathname:"/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9559:(e,s,t)=>{Promise.resolve().then(t.bind(t,9263))},9263:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>UsersPage});var a=t(784),l=t(9885),r=t(6729),n=t(7194),i=t(4901),d=t(1672),c=t(87),o=t(6665),m=t(8626),x=t(9494),u=t(7800),h=t(2032),p=t(6303),b=t(2778),f=t(5131),g=t(4571),j=t(517),v=t(1057),N=t(9518),y=t(2385),w=t(8699),_=t(788),C=t(5905),D=t(4292),U=t(345);function AddUserModal({open:e,onClose:s,onUserAdded:t}){let[r,n]=(0,l.useState)({username:"",email:"",first_name:"",last_name:"",phone:"",role:"support_worker"}),[i,d]=(0,l.useState)(!1),[c,o]=(0,l.useState)({});if(!e)return null;let handleChange=e=>{n({...r,[e.target.name]:e.target.value}),o({...c,[e.target.name]:""})},validate=()=>{let e={};return r.username||(e.username="Username is required"),r.email?/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(r.email)||(e.email="Invalid email"):e.email="Email is required",r.first_name||(e.first_name="First name is required"),r.last_name||(e.last_name="Last name is required"),r.phone||(e.phone="Phone is required"),e},handleSubmit=async e=>{e.preventDefault();let a=validate();if(Object.keys(a).length>0){o(a);return}d(!0);try{await D.x.register({username:r.username,email:r.email,first_name:r.first_name,last_name:r.last_name,phone:r.phone,role:r.role,password:"changeme123",password_confirm:"changeme123"}),U.default.success("User created successfully!"),n({username:"",email:"",first_name:"",last_name:"",phone:"",role:"support_worker"}),t(),s()}catch(e){U.default.error(e.message||"Failed to create user")}finally{d(!1)}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-lg p-8",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add New User"}),(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Username"}),a.jsx("input",{name:"username",value:r.username,onChange:handleChange,className:"input-field w-full",disabled:i}),c.username&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.username})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),a.jsx("input",{name:"email",type:"email",value:r.email,onChange:handleChange,className:"input-field w-full",disabled:i}),c.email&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.email})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"First Name"}),a.jsx("input",{name:"first_name",value:r.first_name,onChange:handleChange,className:"input-field w-full",disabled:i}),c.first_name&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.first_name})]}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Last Name"}),a.jsx("input",{name:"last_name",value:r.last_name,onChange:handleChange,className:"input-field w-full",disabled:i}),c.last_name&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.last_name})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),a.jsx("input",{name:"phone",value:r.phone,onChange:handleChange,className:"input-field w-full",disabled:i}),c.phone&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.phone})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Role"}),(0,a.jsxs)("select",{name:"role",value:r.role,onChange:handleChange,className:"input-field w-full",disabled:i,children:[a.jsx("option",{value:"support_worker",children:"Support Worker"}),a.jsx("option",{value:"practitioner",children:"Practitioner"}),a.jsx("option",{value:"family",children:"Family"}),a.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:s,disabled:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn-primary",disabled:i,children:i?"Saving...":"Save"})]})]})]})})}function EditUserModal({open:e,onClose:s,onUserUpdated:t,user:r}){let[n,i]=(0,l.useState)({username:"",email:"",first_name:"",last_name:"",phone:"",address:"",emergency_contact:"",emergency_phone:"",date_of_birth:"",role:"support_worker"}),[d,c]=(0,l.useState)(!1),[o,m]=(0,l.useState)({});if((0,l.useEffect)(()=>{r&&e&&(i({username:r.username||"",email:r.email||"",first_name:r.first_name||"",last_name:r.last_name||"",phone:r.phone||"",address:r.address||"",emergency_contact:r.emergency_contact||"",emergency_phone:r.emergency_phone||"",date_of_birth:r.date_of_birth?r.date_of_birth.split("T")[0]:"",role:r.role||"support_worker"}),m({}))},[r,e]),!e||!r)return null;let handleChange=e=>{i({...n,[e.target.name]:e.target.value}),m({...o,[e.target.name]:""})},validate=()=>{let e={};return n.username||(e.username="Username is required"),n.email?/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(n.email)||(e.email="Invalid email"):e.email="Email is required",n.first_name||(e.first_name="First name is required"),n.last_name||(e.last_name="Last name is required"),n.phone||(e.phone="Phone is required"),e},handleSubmit=async e=>{e.preventDefault();let a=validate();if(Object.keys(a).length>0){m(a);return}c(!0);try{let e={...n,date_of_birth:n.date_of_birth||null};await D.x.updateUser(r.id,e),U.default.success("User updated successfully!"),t(),s()}catch(e){U.default.error(e.message||"Failed to update user")}finally{c(!1)}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:(0,a.jsxs)("div",{className:"bg-white rounded-[20px] shadow-lg w-full max-w-2xl p-8 max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-[#000000]",children:"Edit User"}),a.jsx("button",{onClick:s,className:"text-[#6D6D6D] hover:text-[#000000] transition-colors",disabled:d,children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#000000] mb-2",children:"Username"}),a.jsx("input",{name:"username",value:n.username,onChange:handleChange,className:"w-full px-4 py-3 border border-[#D3D3D3] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent transition-colors",disabled:d,placeholder:"Enter username"}),o.username&&a.jsx("p",{className:"text-[#FF6B6B] text-sm mt-1",children:o.username})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#000000] mb-2",children:"Email"}),a.jsx("input",{name:"email",type:"email",value:n.email,onChange:handleChange,className:"w-full px-4 py-3 border border-[#D3D3D3] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent transition-colors",disabled:d,placeholder:"Enter email address"}),o.email&&a.jsx("p",{className:"text-[#FF6B6B] text-sm mt-1",children:o.email})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#000000] mb-2",children:"First Name"}),a.jsx("input",{name:"first_name",value:n.first_name,onChange:handleChange,className:"w-full px-4 py-3 border border-[#D3D3D3] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent transition-colors",disabled:d,placeholder:"Enter first name"}),o.first_name&&a.jsx("p",{className:"text-[#FF6B6B] text-sm mt-1",children:o.first_name})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#000000] mb-2",children:"Last Name"}),a.jsx("input",{name:"last_name",value:n.last_name,onChange:handleChange,className:"w-full px-4 py-3 border border-[#D3D3D3] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent transition-colors",disabled:d,placeholder:"Enter last name"}),o.last_name&&a.jsx("p",{className:"text-[#FF6B6B] text-sm mt-1",children:o.last_name})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#000000] mb-2",children:"Phone"}),a.jsx("input",{name:"phone",type:"tel",value:n.phone,onChange:handleChange,className:"w-full px-4 py-3 border border-[#D3D3D3] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent transition-colors",disabled:d,placeholder:"Enter phone number"}),o.phone&&a.jsx("p",{className:"text-[#FF6B6B] text-sm mt-1",children:o.phone})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#000000] mb-2",children:"Role"}),(0,a.jsxs)("select",{name:"role",value:n.role,onChange:handleChange,className:"w-full px-4 py-3 border border-[#D3D3D3] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent transition-colors",disabled:d,children:[a.jsx("option",{value:"support_worker",children:"Support Worker"}),a.jsx("option",{value:"practitioner",children:"Practitioner"}),a.jsx("option",{value:"family",children:"Family"}),a.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#000000] mb-2",children:"Date of Birth"}),a.jsx("input",{name:"date_of_birth",type:"date",value:n.date_of_birth,onChange:handleChange,className:"w-full px-4 py-3 border border-[#D3D3D3] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent transition-colors",disabled:d})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#000000] mb-2",children:"Emergency Phone"}),a.jsx("input",{name:"emergency_phone",type:"tel",value:n.emergency_phone,onChange:handleChange,className:"w-full px-4 py-3 border border-[#D3D3D3] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent transition-colors",disabled:d,placeholder:"Enter emergency phone"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#000000] mb-2",children:"Address"}),a.jsx("input",{name:"address",value:n.address,onChange:handleChange,className:"w-full px-4 py-3 border border-[#D3D3D3] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent transition-colors",disabled:d,placeholder:"Enter address"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#000000] mb-2",children:"Emergency Contact"}),a.jsx("input",{name:"emergency_contact",value:n.emergency_contact,onChange:handleChange,className:"w-full px-4 py-3 border border-[#D3D3D3] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent transition-colors",disabled:d,placeholder:"Enter emergency contact name"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4 pt-6 border-t border-[#E0E0E0]",children:[a.jsx("button",{type:"button",onClick:s,className:"px-6 py-3 bg-[#F0F0F0] text-[#000000] rounded-lg hover:bg-[#E5E5E5] transition-colors font-medium",disabled:d,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-6 py-3 bg-[#4ECDC4] text-white rounded-lg hover:bg-[#3DB9B2] active:bg-[#37A29F] transition-colors font-medium disabled:bg-[#A3A3A3]",disabled:d,children:d?"Updating...":"Update User"})]})]})]})})}function DeleteConfirmationDialog({open:e,onClose:s,onConfirm:t,user:l,loading:r=!1}){return e&&l?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:(0,a.jsxs)("div",{className:"bg-white rounded-[20px] shadow-lg w-full max-w-md p-8",children:[a.jsx("div",{className:"flex items-center justify-center mb-6",children:a.jsx("div",{className:"w-16 h-16 bg-[#FF6B6B] bg-opacity-10 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-8 h-8 text-[#FF6B6B]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.232 15.5c-.77.833.192 2.5 1.732 2.5z"})})})}),(0,a.jsxs)("div",{className:"text-center mb-8",children:[a.jsx("h2",{className:"text-2xl font-bold text-[#000000] mb-3",children:"Delete User"}),(0,a.jsxs)("p",{className:"text-[#6D6D6D] mb-2",children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold text-[#000000]",children:l.full_name}),"?"]}),a.jsx("p",{className:"text-sm text-[#A3A3A3]",children:"This action cannot be undone. All user data will be permanently removed."})]}),a.jsx("div",{className:"bg-[#F9F5F4] rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-[#E0E0E0] rounded-full flex items-center justify-center",children:l.profile_image?a.jsx("img",{src:l.profile_image,alt:l.full_name,className:"w-10 h-10 rounded-full object-cover"}):a.jsx("svg",{className:"w-5 h-5 text-[#000000]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[a.jsx("p",{className:"font-semibold text-[#000000]",children:l.full_name}),a.jsx("p",{className:"text-sm text-[#6D6D6D]",children:l.email}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:l.is_admin?"Admin":"Carer"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l.approved?"bg-[#4ECDC4] bg-opacity-10 text-[#4ECDC4]":"bg-yellow-100 text-yellow-800"}`,children:l.approved?"Active":"Pending"})]})]})]})}),(0,a.jsxs)("div",{className:"flex gap-4",children:[a.jsx("button",{type:"button",onClick:s,className:"flex-1 px-6 py-3 bg-[#F0F0F0] text-[#000000] rounded-lg hover:bg-[#E5E5E5] transition-colors font-medium",disabled:r,children:"Cancel"}),a.jsx("button",{type:"button",onClick:t,className:"flex-1 px-6 py-3 bg-[#FF6B6B] text-white rounded-lg hover:bg-[#FF5252] transition-colors font-medium disabled:bg-[#A3A3A3]",disabled:r,children:r?"Deleting...":"Delete User"})]})]})}):null}let UserCard=({user:e,onApprove:s,onDisable:t,onEnable:r,onEdit:n,onDelete:N})=>{let[y,_]=(0,l.useState)(!1),[C,D]=(0,l.useState)(!1),handleApprove=async()=>{D(!0);try{await s(e.id),_(!1)}catch(e){console.error("Error approving user:",e)}finally{D(!1)}},handleDisable=async()=>{D(!0);try{await t(e.id),_(!1)}catch(e){console.error("Error disabling user:",e)}finally{D(!1)}},handleEnable=async()=>{D(!0);try{await r(e.id),_(!1)}catch(e){console.error("Error enabling user:",e)}finally{D(!1)}};return(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-icon-profile-container rounded-full flex items-center justify-center",children:e.profile_image?a.jsx("img",{src:e.profile_image,alt:e.full_name,className:"w-12 h-12 rounded-full object-cover"}):a.jsx(d.Z,{className:"w-6 h-6 text-icon-profile"})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-card-title",children:e.full_name}),a.jsx("p",{className:"text-sm text-card-subtext",children:e.email}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsxs)("span",{className:(0,w.cn)("px-2 py-1 rounded-full text-xs font-medium",e.is_admin?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"),children:[e.is_admin?a.jsx(i.Z,{className:"w-4 h-4"}):a.jsx(d.Z,{className:"w-4 h-4"}),a.jsx("span",{className:"ml-1",children:e.is_admin?"Admin":"Carer"})]}),a.jsx("span",{className:(0,w.cn)("px-2 py-1 rounded-full text-xs font-medium",(e=>{switch(e){case"active":return"bg-text-positive/10 text-text-positive";case"pending":return"bg-yellow-100 text-yellow-800";case"inactive":return"bg-text-danger/10 text-text-danger";default:return"bg-gray-100 text-gray-800"}})(e.approved?"active":"pending")),children:e.approved?"Active":"Pending"})]})]})]}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx("button",{onClick:()=>_(!y),className:"p-2 rounded-lg hover:bg-bg-highlight transition-colors",disabled:C,children:C?a.jsx(c.Z,{className:"w-4 h-4 animate-spin"}):a.jsx(o.Z,{className:"w-4 h-4 text-nav-icon"})}),y&&a.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-bg-primary border border-border-default rounded-lg shadow-card z-50",children:(0,a.jsxs)("div",{className:"py-2",children:[(0,a.jsxs)("button",{className:"w-full flex items-center gap-3 px-4 py-2 text-left hover:bg-bg-highlight transition-colors",children:[a.jsx(m.Z,{className:"w-4 h-4 text-nav-icon"}),a.jsx("span",{className:"text-sm text-text-primary",children:"View Profile"})]}),(0,a.jsxs)("button",{onClick:()=>n(e),className:"w-full flex items-center gap-3 px-4 py-2 text-left hover:bg-bg-highlight transition-colors",children:[a.jsx(x.Z,{className:"w-4 h-4 text-nav-icon"}),a.jsx("span",{className:"text-sm text-text-primary",children:"Edit User"})]}),(0,a.jsxs)("button",{className:"w-full flex items-center gap-3 px-4 py-2 text-left hover:bg-bg-highlight transition-colors",children:[a.jsx(u.Z,{className:"w-4 h-4 text-nav-icon"}),a.jsx("span",{className:"text-sm text-text-primary",children:"Reset Password"})]}),!e.approved&&(0,a.jsxs)("button",{onClick:handleApprove,className:"w-full flex items-center gap-3 px-4 py-2 text-left hover:bg-bg-highlight transition-colors text-text-positive",children:[a.jsx(h.Z,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Approve User"})]}),a.jsx("div",{className:"border-t border-border-default my-2"}),(0,a.jsxs)("button",{onClick:()=>N(e),className:"w-full flex items-center gap-3 px-4 py-2 text-left hover:bg-bg-highlight transition-colors text-text-danger",children:[a.jsx(p.Z,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Delete User"})]}),e.approved&&e.is_active_carer&&(0,a.jsxs)("button",{onClick:handleDisable,className:"w-full flex items-center gap-3 px-4 py-2 text-left hover:bg-bg-highlight transition-colors text-text-danger",children:[a.jsx(b.Z,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Disable User"})]}),!e.is_active_carer&&(0,a.jsxs)("button",{onClick:handleEnable,className:"w-full flex items-center gap-3 px-4 py-2 text-left hover:bg-bg-highlight transition-colors text-text-positive",children:[a.jsx(f.Z,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Enable User"})]})]})})]})]}),(0,a.jsxs)("div",{className:"space-y-3 mb-4",children:[e.phone&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(g.Z,{className:"w-4 h-4 text-nav-icon"}),a.jsx("span",{className:"text-sm text-card-subtext",children:e.phone})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(j.Z,{className:"w-4 h-4 text-nav-icon"}),(0,a.jsxs)("span",{className:"text-sm text-card-subtext",children:["Joined ",(0,w.p6)(e.created_at)]})]})]}),!e.approved&&(0,a.jsxs)("div",{className:"flex items-center gap-2 pt-4 border-t border-border-default",children:[(0,a.jsxs)("button",{onClick:handleApprove,disabled:C,className:"btn-primary flex items-center gap-2",children:[C?a.jsx(c.Z,{className:"w-4 h-4 animate-spin"}):a.jsx(h.Z,{className:"w-4 h-4"}),"Approve"]}),(0,a.jsxs)("button",{onClick:handleDisable,disabled:C,className:"btn-secondary flex items-center gap-2",children:[C?a.jsx(c.Z,{className:"w-4 h-4 animate-spin"}):a.jsx(v.Z,{className:"w-4 h-4"}),"Reject"]})]})]})},UserTable=({users:e,onApprove:s,onDisable:t,onEnable:l,onEdit:r,onDelete:n})=>(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"All Users"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[a.jsx(N.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-muted"}),a.jsx("input",{type:"text",placeholder:"Search users...",className:"input-field pl-10 w-64"})]}),(0,a.jsxs)("select",{className:"input-field w-32",children:[a.jsx("option",{value:"all",children:"All Types"}),a.jsx("option",{value:"admin",children:"Admins"}),a.jsx("option",{value:"carer",children:"Carers"})]}),(0,a.jsxs)("select",{className:"input-field w-32",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-border-default",children:[a.jsx("th",{className:"text-left py-3 px-4 font-medium text-text-primary",children:"User"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-text-primary",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-text-primary",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-text-primary",children:"Phone"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-text-primary",children:"Joined"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-text-primary",children:"Last Login"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-text-primary",children:"Actions"})]})}),a.jsx("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{className:"border-b border-border-default hover:bg-bg-highlight",children:[a.jsx("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-text-primary font-medium",children:e.full_name}),a.jsx("p",{className:"text-sm text-text-secondary",children:e.email})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:(0,w.cn)("px-2 py-1 rounded-full text-xs font-medium",e.is_admin?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"),children:e.is_admin?"Admin":"Carer"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:(0,w.cn)("px-2 py-1 rounded-full text-xs font-medium",e.approved&&e.is_active_carer&&"bg-text-positive/10 text-text-positive",!e.approved&&"bg-yellow-100 text-yellow-800",!e.is_active_carer&&"bg-text-danger/10 text-text-danger"),children:e.approved?e.is_active_carer?"Active":"Inactive":"Pending"})}),a.jsx("td",{className:"py-3 px-4 text-text-secondary",children:e.phone||"-"}),a.jsx("td",{className:"py-3 px-4 text-text-secondary",children:(0,w.p6)(e.created_at)}),a.jsx("td",{className:"py-3 px-4 text-text-secondary",children:"Never"}),a.jsx("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[!e.approved&&a.jsx("button",{onClick:()=>s(e.id),className:"p-1 text-text-positive hover:bg-text-positive/10 rounded",title:"Approve User",children:a.jsx(h.Z,{className:"w-4 h-4"})}),e.approved&&e.is_active_carer&&a.jsx("button",{onClick:()=>t(e.id),className:"p-1 text-text-danger hover:bg-text-danger/10 rounded",title:"Disable User",children:a.jsx(b.Z,{className:"w-4 h-4"})}),!e.is_active_carer&&a.jsx("button",{onClick:()=>l(e.id),className:"p-1 text-text-positive hover:bg-text-positive/10 rounded",title:"Enable User",children:a.jsx(f.Z,{className:"w-4 h-4"})}),a.jsx("button",{className:"p-1 text-nav-icon hover:bg-bg-highlight rounded",children:a.jsx(o.Z,{className:"w-4 h-4"})})]})})]},e.id))})]})})]});function UsersPage(){let{user:e,loading:s}=(0,_.useRequireAdmin)(),{users:t,isLoading:o,mutate:m}=(0,C.UV)(),[x,u]=(0,l.useState)("grid"),[h,p]=(0,l.useState)(""),[g,v]=(0,l.useState)("all"),[k,E]=(0,l.useState)("all"),[A,F]=(0,l.useState)(!1),[S,P]=(0,l.useState)(!1),[Z,q]=(0,l.useState)(!1),[B,L]=(0,l.useState)(null),[M,z]=(0,l.useState)(!1),T=t.filter(e=>{let s=e.full_name?.toLowerCase().includes(h.toLowerCase())||e.email?.toLowerCase().includes(h.toLowerCase()),t="all"===g||"active"===g&&e.approved&&e.is_active_carer||"pending"===g&&!e.approved||"inactive"===g&&!e.is_active_carer,a="all"===k||"admin"===k&&e.is_admin||"carer"===k&&!e.is_admin;return s&&t&&a}),handleApproveUser=async e=>{try{await D.x.approveUser(e),U.default.success("User approved successfully"),m()}catch(e){U.default.error(e.message||"Failed to approve user")}},handleDisableUser=async e=>{try{await D.x.disableUser(e),U.default.success("User disabled successfully"),m()}catch(e){U.default.error(e.message||"Failed to disable user")}},handleEnableUser=async e=>{try{await D.x.enableUser(e),U.default.success("User enabled successfully"),m()}catch(e){U.default.error(e.message||"Failed to enable user")}},handleEditUser=e=>{L(e),P(!0)},handleDeleteUser=e=>{L(e),q(!0)},handleConfirmDelete=async()=>{if(B){z(!0);try{await D.x.deleteUser(B.id),U.default.success("User deleted successfully"),m(),q(!1),L(null)}catch(e){U.default.error(e.message||"Failed to delete user")}finally{z(!1)}}},handleCloseModals=()=>{P(!1),q(!1),L(null)},getStatusCount=e=>{switch(e){case"active":return t.filter(e=>e.approved&&e.is_active_carer).length;case"pending":return t.filter(e=>!e.approved).length;case"inactive":return t.filter(e=>!e.is_active_carer).length;default:return 0}};return s||o?a.jsx(r.Z,{children:a.jsx("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx(c.Z,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-btn-primary"}),a.jsx("p",{className:"text-text-secondary",children:"Loading users..."})]})})}):a.jsx(r.Z,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx(n.Z,{items:[{label:"Dashboard",href:"/dashboard"},{label:"User Management"}]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:"User Management"}),a.jsx("p",{className:"text-text-secondary",children:"Manage carers and administrators"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center bg-bg-highlight rounded-lg p-1",children:[a.jsx("button",{onClick:()=>u("grid"),className:(0,w.cn)("px-3 py-1 rounded-md text-sm font-medium transition-colors","grid"===x?"bg-bg-primary text-text-primary shadow-sm":"text-text-secondary hover:text-text-primary"),children:"Grid"}),a.jsx("button",{onClick:()=>u("table"),className:(0,w.cn)("px-3 py-1 rounded-md text-sm font-medium transition-colors","table"===x?"bg-bg-primary text-text-primary shadow-sm":"text-text-secondary hover:text-text-primary"),children:"Table"})]}),(0,a.jsxs)("button",{className:"btn-primary flex items-center gap-2",onClick:()=>F(!0),children:[a.jsx(y.Z,{className:"w-4 h-4"}),"Add User"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsx("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-card-subtext",children:"Total Users"}),a.jsx("p",{className:"text-2xl font-bold text-card-title",children:t.length})]}),a.jsx("div",{className:"w-12 h-12 bg-btn-primary rounded-lg flex items-center justify-center",children:a.jsx(d.Z,{className:"w-6 h-6 text-white"})})]})}),a.jsx("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-card-subtext",children:"Carers"}),a.jsx("p",{className:"text-2xl font-bold text-card-title",children:t.filter(e=>!1===e.is_admin).length})]}),a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(d.Z,{className:"w-6 h-6 text-blue-800"})})]})}),a.jsx("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-card-subtext",children:"Admins"}),a.jsx("p",{className:"text-2xl font-bold text-card-title",children:t.filter(e=>!0===e.is_admin).length})]}),a.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(i.Z,{className:"w-6 h-6 text-purple-800"})})]})}),a.jsx("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-card-subtext",children:"Pending Approval"}),a.jsx("p",{className:"text-2xl font-bold text-card-title",children:getStatusCount("pending")})]}),a.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:a.jsx(j.Z,{className:"w-6 h-6 text-yellow-800"})})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-card-subtext",children:"Active Users"}),a.jsx("p",{className:"text-2xl font-bold text-card-title",children:getStatusCount("active")})]}),a.jsx("div",{className:"w-12 h-12 bg-text-positive/10 rounded-lg flex items-center justify-center",children:a.jsx(f.Z,{className:"w-6 h-6 text-text-positive"})})]})}),a.jsx("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-card-subtext",children:"Inactive Users"}),a.jsx("p",{className:"text-2xl font-bold text-card-title",children:getStatusCount("inactive")})]}),a.jsx("div",{className:"w-12 h-12 bg-text-danger/10 rounded-lg flex items-center justify-center",children:a.jsx(b.Z,{className:"w-6 h-6 text-text-danger"})})]})})]}),a.jsx("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[a.jsx(N.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-muted"}),a.jsx("input",{type:"text",placeholder:"Search users by name or email...",value:h,onChange:e=>p(e.target.value),className:"input-field pl-10"})]}),(0,a.jsxs)("select",{value:k,onChange:e=>E(e.target.value),className:"input-field w-32",children:[a.jsx("option",{value:"all",children:"All Types"}),a.jsx("option",{value:"admin",children:"Admins"}),a.jsx("option",{value:"carer",children:"Carers"})]}),(0,a.jsxs)("select",{value:g,onChange:e=>v(e.target.value),className:"input-field w-32",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"inactive",children:"Inactive"})]})]})}),0===T.length?(0,a.jsxs)("div",{className:"card p-12 text-center",children:[a.jsx(d.Z,{className:"w-12 h-12 text-text-muted mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-card-title mb-2",children:"No users found"}),a.jsx("p",{className:"text-text-secondary",children:h||"all"!==g||"all"!==k?"Try adjusting your search or filters":"No users have been added yet"})]}):"grid"===x?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:T.map(e=>a.jsx(UserCard,{user:e,onApprove:handleApproveUser,onDisable:handleDisableUser,onEnable:handleEnableUser,onEdit:handleEditUser,onDelete:handleDeleteUser},e.id))}):a.jsx(UserTable,{users:T,onApprove:handleApproveUser,onDisable:handleDisableUser,onEnable:handleEnableUser,onEdit:handleEditUser,onDelete:handleDeleteUser}),a.jsx(AddUserModal,{open:A,onClose:()=>F(!1),onUserAdded:m}),a.jsx(EditUserModal,{open:S,onClose:handleCloseModals,onUserUpdated:m,user:B}),a.jsx(DeleteConfirmationDialog,{open:Z,onClose:handleCloseModals,onConfirm:handleConfirmDelete,user:B,loading:M})]})})}},7498:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>n,__esModule:()=>r,default:()=>d});var a=t(5153);let l=(0,a.createProxy)(String.raw`/Users/mandaza/Documents/Project/tavonga/web-app/app/users/page.tsx`),{__esModule:r,$$typeof:n}=l,i=l.default,d=i}};var s=require("../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[4312,9708,6897,516,4809,6120,5884,2234,3672,5905],()=>__webpack_exec__(5864));module.exports=t})();