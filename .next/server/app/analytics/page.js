(()=>{var e={};e.id=4109,e.ids=[4109],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7310:e=>{"use strict";e.exports=require("url")},5424:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>p,tree:()=>d});var t=a(7096),i=a(6132),r=a(7284),l=a.n(r),n=a(2564),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);a.d(s,c);let d=["",{children:["analytics",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,1466)),"/Users/mandaza/Documents/Project/tavonga/web-app/app/analytics/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,498)),"/Users/mandaza/Documents/Project/tavonga/web-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/mandaza/Documents/Project/tavonga/web-app/app/analytics/page.tsx"],x="/analytics/page",m={require:a,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/analytics/page",pathname:"/analytics",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9851:(e,s,a)=>{Promise.resolve().then(a.bind(a,7561))},7561:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>TavongaAnalyticsPage});var t=a(784),i=a(9885),r=a(6729),l=a(7194),n=a(5441),c=a(517),d=a(9815),o=a(696),x=a(6494),m=a(4901),p=a(5131),g=a(5957),u=a(2032),h=a(1438),v=a(5256),j=a(1672),b=a(1814),y=a(4409),f=a(3223),_=a(8699),N=a(2252),w=a(5905);let BehaviorStatsCard=({title:e,value:s,icon:a,trend:i,severity:r,color:l="blue"})=>t.jsx("div",{className:"card p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm text-text-secondary mb-1",children:e}),t.jsx("p",{className:"text-2xl font-semibold text-text-primary",children:s}),i&&t.jsx("p",{className:"text-sm mt-1 text-text-secondary",children:i}),r&&(0,t.jsxs)("p",{className:(0,_.cn)("text-xs mt-1 font-medium",{low:"text-green-600",medium:"text-yellow-600",high:"text-orange-600",critical:"text-red-600"}[r]),children:[r.toUpperCase()," SEVERITY"]})]}),t.jsx("div",{className:(0,_.cn)("p-3 rounded-full",{blue:"bg-blue-50 text-blue-600",green:"bg-green-50 text-green-600",red:"bg-red-50 text-red-600",yellow:"bg-yellow-50 text-yellow-600",purple:"bg-purple-50 text-purple-600",orange:"bg-orange-50 text-orange-600"}[l]),children:t.jsx(a,{className:"w-6 h-6"})})]})}),HourlyBehaviorHeatmap=({temporalData:e})=>{if(!e?.temporal_patterns?.hourly)return t.jsx("div",{children:"Loading..."});let s=e.temporal_patterns.hourly,a=Math.max(...s.map(e=>e.count));return(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Hourly Behavior Patterns"}),t.jsx(n.Z,{className:"w-5 h-5 text-nav-icon"})]}),t.jsx("div",{className:"grid grid-cols-12 gap-1",children:s.map(e=>{let s=a>0?e.count/a:0;return t.jsx("div",{className:(0,_.cn)("aspect-square rounded-sm flex items-center justify-center text-xs font-medium text-white bg-red-500",s>.8?"opacity-100":s>.6?"opacity-80":s>.4?"opacity-60":s>.2?"opacity-40":"opacity-20"),title:`${e.hour}:00 - ${e.count} behaviors (${e.percentage}%)`,children:e.hour},e.hour)})}),(0,t.jsxs)("div",{className:"flex justify-between items-center mt-4 text-xs text-text-secondary",children:[t.jsx("span",{children:"12 AM"}),t.jsx("span",{children:"Peak behavior times highlighted"}),t.jsx("span",{children:"11 PM"})]})]})},WeeklyPatternsChart=({temporalData:e})=>{if(!e?.temporal_patterns?.daily)return t.jsx("div",{children:"Loading..."});let s=e.temporal_patterns.daily,a={labels:s.map(e=>e.day_name),datasets:[{label:"Behavior Count",data:s.map(e=>e.count),backgroundColor:s.map(e=>e.count>5?"#EF4444":e.count>2?"#F59E0B":"#10B981"),borderWidth:0,borderRadius:4}]};return(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Weekly Behavior Patterns"}),t.jsx(c.Z,{className:"w-5 h-5 text-nav-icon"})]}),t.jsx("div",{className:"h-64",children:t.jsx(f.$Q,{data:a,options:{...N.q_,plugins:{...N.q_.plugins,legend:{display:!1}}}})})]})},TriggerAnalysisSection=({triggerData:e})=>{if(!e)return t.jsx("div",{children:"Loading trigger analysis..."});let s={labels:e.activity_triggers?.slice(0,8).map(e=>e.related_activity__name)||[],datasets:[{label:"Incidents",data:e.activity_triggers?.slice(0,8).map(e=>e.count)||[],backgroundColor:"#FF6B6B",borderColor:"#E53E3E",borderWidth:2}]},a={labels:e.location_triggers?.map(e=>e.location)||[],datasets:[{data:e.location_triggers?.map(e=>e.count)||[],backgroundColor:["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7"],borderWidth:0}]};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Activity Triggers"}),t.jsx(d.Z,{className:"w-5 h-5 text-nav-icon"})]}),t.jsx("div",{className:"h-64",children:t.jsx(f.$Q,{data:s,options:{...N.q_,plugins:{...N.q_.plugins,legend:{display:!1}},indexAxis:"y"}})})]}),(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Location Patterns"}),t.jsx(o.Z,{className:"w-5 h-5 text-nav-icon"})]}),t.jsx("div",{className:"h-64",children:t.jsx(f.$I,{data:a,options:{...N.q_,plugins:{...N.q_.plugins,legend:{...N.q_.plugins.legend,position:"bottom"}},cutout:"60%"}})})]})]}),(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Most Common Triggers"}),t.jsx(x.Z,{className:"w-5 h-5 text-nav-icon"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.identified_triggers?.slice(0,9).map(([e,s],a)=>t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm font-medium text-red-800",children:e}),t.jsxs("span",{className:"text-xs bg-red-100 text-red-600 px-2 py-1 rounded-full",children:[s,"x"]})]})},a))})]})]})},InterventionEffectivenessSection=({interventionData:e})=>{if(!e)return t.jsx("div",{children:"Loading intervention analysis..."});let s={labels:e.intervention_types?.map(e=>e.intervention_used)||[],datasets:[{label:"Success Rate (%)",data:e.intervention_types?.map(e=>(100*e.success_rate).toFixed(1))||[],backgroundColor:e.intervention_types?.map(e=>e.success_rate>.8?"#10B981":e.success_rate>.6?"#F59E0B":"#EF4444")||[],borderWidth:0,borderRadius:4}]},a={labels:e.worker_success_rates?.map(e=>`${e.user__first_name} ${e.user__last_name}`)||[],datasets:[{label:"Success Rate (%)",data:e.worker_success_rates?.map(e=>(100*e.success_rate).toFixed(1))||[],backgroundColor:"#4ECDC4",borderColor:"#3DB9B2",borderWidth:2,borderRadius:4}]};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Intervention Success Rates"}),t.jsx(m.Z,{className:"w-5 h-5 text-nav-icon"})]}),t.jsx("div",{className:"h-64",children:t.jsx(f.$Q,{data:s,options:{...N.q_,plugins:{...N.q_.plugins,legend:{display:!1}},scales:{...N.q_.scales,y:{...N.q_.scales.y,beginAtZero:!0,max:100,ticks:{...N.q_.scales.y.ticks,callback:function(e){return e+"%"}}}}}})})]}),(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Worker Effectiveness"}),t.jsx(p.Z,{className:"w-5 h-5 text-nav-icon"})]}),t.jsx("div",{className:"h-64",children:t.jsx(f.$Q,{data:a,options:{...N.q_,plugins:{...N.q_.plugins,legend:{display:!1}},scales:{...N.q_.scales,y:{...N.q_.scales.y,beginAtZero:!0,max:100,ticks:{...N.q_.scales.y.ticks,callback:function(e){return e+"%"}}}}}})})]})]}),(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Best Practices"}),t.jsx(g.Z,{className:"w-5 h-5 text-nav-icon"})]}),t.jsx("div",{className:"space-y-3",children:e.best_practices?.slice(0,5).map((e,s)=>t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(u.Z,{className:"w-5 h-5 text-green-500 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-green-800",children:e.intervention_used}),t.jsx("p",{className:"text-sm text-green-700 mt-1",children:e.intervention_notes}),t.jsxs("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded-full mt-2 inline-block",children:["Used ",e.usage_count," times successfully"]})]})]})},s))})]})]})},GoalsActivitiesSection=({goalData:e,activityData:s,masteryData:a})=>{if(!e||!s)return t.jsx("div",{children:"Loading goals & activities analysis..."});let i={labels:e.successful_goals?.map(e=>e.name)||[],datasets:[{label:"Progress %",data:e.successful_goals?.map(e=>e.progress_percentage)||[],backgroundColor:"#10B981",borderColor:"#059669",borderWidth:2,borderRadius:4}]},r={labels:s.category_performance?.map(e=>e.activity__category)||[],datasets:[{label:"Completion Rate %",data:s.category_performance?.map(e=>(100*e.completion_rate).toFixed(1))||[],backgroundColor:"#4F46E5",borderColor:"#4338CA",borderWidth:2,borderRadius:4}]};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Goal Progress"}),t.jsx(o.Z,{className:"w-5 h-5 text-nav-icon"})]}),t.jsx("div",{className:"h-64",children:t.jsx(f.$Q,{data:i,options:{...N.q_,plugins:{...N.q_.plugins,legend:{display:!1}},scales:{...N.q_.scales,y:{...N.q_.scales.y,beginAtZero:!0,max:100,ticks:{...N.q_.scales.y.ticks,callback:function(e){return e+"%"}}}}}})})]}),(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Activity Category Performance"}),t.jsx(d.Z,{className:"w-5 h-5 text-nav-icon"})]}),t.jsx("div",{className:"h-64",children:t.jsx(f.$Q,{data:r,options:{...N.q_,plugins:{...N.q_.plugins,legend:{display:!1}},scales:{...N.q_.scales,y:{...N.q_.scales.y,beginAtZero:!0,max:100,ticks:{...N.q_.scales.y.ticks,callback:function(e){return e+"%"}}}}}})})]})]}),a&&(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Skill Mastery Progress"}),t.jsx(h.Z,{className:"w-5 h-5 text-nav-icon"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.mastery_analysis?.slice(0,6).map((e,s)=>t.jsxs("div",{className:_.cn("border rounded-lg p-4","advanced"===e.mastery_level?"bg-green-50 border-green-200":"bg-blue-50 border-blue-200"),children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h4",{className:"font-medium text-sm",children:e.activity_name}),t.jsx("span",{className:_.cn("text-xs px-2 py-1 rounded-full font-medium","advanced"===e.mastery_level?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"),children:e.mastery_level})]}),t.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[t.jsxs("div",{children:["Completions: ",e.total_completions]}),e.difficulty_improvement>0&&t.jsxs("div",{className:"text-green-600",children:["Difficulty ↓ ",e.difficulty_improvement.toFixed(1)]}),e.satisfaction_improvement>0&&t.jsxs("div",{className:"text-blue-600",children:["Satisfaction ↑ ",e.satisfaction_improvement.toFixed(1)]})]})]},s))})]})]})};function TavongaAnalyticsPage(){let[e,s]=(0,i.useState)("30"),[a,c]=(0,i.useState)("all"),[d,p]=(0,i.useState)("overview"),{temporalPatterns:u,isLoading:h}=(0,w.Ad)({days:e,worker:"all"===a?void 0:a}),{triggerAnalysis:f,isLoading:N}=(0,w.lM)({days:e,worker:"all"===a?void 0:a}),{interventionAnalysis:k,isLoading:q}=(0,w.JX)({days:e,worker:"all"===a?void 0:a}),{workerAnalysis:C,isLoading:P}=(0,w.QK)({days:e}),{predictiveIndicators:Z,isLoading:A}=(0,w.Ev)({days:e}),{goalAnalytics:B,isLoading:S}=(0,w.sN)(),{activityAnalytics:E,isLoading:D}=(0,w.C2)(),{masteryTracking:L,isLoading:F}=(0,w.Og)(),$=[{id:"overview",label:"Overview",icon:v.Z},{id:"temporal",label:"Time Patterns",icon:n.Z},{id:"triggers",label:"Triggers",icon:x.Z},{id:"interventions",label:"Interventions",icon:m.Z},{id:"workers",label:"Support Workers",icon:j.Z},{id:"goals",label:"Goals & Activities",icon:o.Z},{id:"predictive",label:"Insights",icon:g.Z}];return t.jsx(r.Z,{children:(0,t.jsxs)("div",{className:"space-y-6",children:[t.jsx(l.Z,{items:[{label:"Dashboard",href:"/dashboard"},{label:"Tavonga Analytics"}]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:"Tavonga's Behavioral Analytics"}),t.jsx("p",{className:"text-text-secondary",children:"Comprehensive insights into behavior patterns, triggers, and interventions"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("select",{value:e,onChange:e=>s(e.target.value),className:"input-field w-32",children:[t.jsx("option",{value:"7",children:"Last 7 days"}),t.jsx("option",{value:"30",children:"Last 30 days"}),t.jsx("option",{value:"90",children:"Last 90 days"}),t.jsx("option",{value:"365",children:"Last year"})]}),(0,t.jsxs)("select",{value:a,onChange:e=>c(e.target.value),className:"input-field w-40",children:[t.jsx("option",{value:"all",children:"All Workers"}),t.jsx("option",{value:"1",children:"Sarah Johnson"}),t.jsx("option",{value:"2",children:"Michael Chen"}),t.jsx("option",{value:"3",children:"Emma Davis"})]})]})]}),t.jsx("div",{className:"border-b border-border-default",children:t.jsx("nav",{className:"flex space-x-8 overflow-x-auto",children:$.map(e=>(0,t.jsxs)("button",{onClick:()=>p(e.id),className:(0,_.cn)("flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap",d===e.id?"border-brand-primary text-brand-primary":"border-transparent text-text-secondary hover:text-text-primary hover:border-border-default"),children:[t.jsx(e.icon,{className:"w-4 h-4"}),e.label]},e.id))})}),"overview"===d&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx(BehaviorStatsCard,{title:"Total Behaviors",value:u?.duration_stats?.total_behaviors||0,icon:b.Z,trend:"Last 30 days",color:"red"}),t.jsx(BehaviorStatsCard,{title:"Avg Duration",value:`${u?.duration_stats?.avg_duration?.toFixed(1)||0} min`,icon:n.Z,trend:"Per incident",color:"orange"}),t.jsx(BehaviorStatsCard,{title:"Success Rate",value:`${k?.overall_success_rate||0}%`,icon:m.Z,trend:"Interventions",color:"green"}),t.jsx(BehaviorStatsCard,{title:"Goal Progress",value:`${B?.completion_rate||0}%`,icon:o.Z,trend:"Overall completion",color:"blue"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsx(HourlyBehaviorHeatmap,{temporalData:u}),t.jsx(WeeklyPatternsChart,{temporalData:u})]})]}),"temporal"===d&&(0,t.jsxs)("div",{className:"space-y-6",children:[t.jsx(HourlyBehaviorHeatmap,{temporalData:u}),t.jsx(WeeklyPatternsChart,{temporalData:u})]}),"triggers"===d&&t.jsx(TriggerAnalysisSection,{triggerData:f}),"interventions"===d&&t.jsx(InterventionEffectivenessSection,{interventionData:k}),"workers"===d&&(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Support Worker Analysis"}),t.jsx(j.Z,{className:"w-5 h-5 text-nav-icon"})]}),P?t.jsx("p",{className:"text-text-secondary",children:"Loading worker analysis..."}):t.jsx("div",{className:"space-y-4",children:C?.worker_performance?.map((e,s)=>t.jsx("div",{className:"border rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h4",{className:"font-medium",children:[e.user__first_name," ",e.user__last_name]}),t.jsxs("div",{className:"flex gap-4 text-sm",children:[t.jsxs("span",{children:["Incidents: ",e.total_incidents]}),t.jsxs("span",{children:["Success Rate: ",(100*e.intervention_success_rate).toFixed(1),"%"]})]})]})},s))})]}),"goals"===d&&t.jsx(GoalsActivitiesSection,{goalData:B,activityData:E,masteryData:L}),"predictive"===d&&t.jsx("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-title",children:"Early Warning Signs"}),t.jsx(y.Z,{className:"w-5 h-5 text-nav-icon"})]}),A?t.jsx("p",{className:"text-text-secondary",children:"Loading predictive analysis..."}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Z?.warning_signs?.slice(0,8).map(([e,s],a)=>t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"font-medium text-yellow-800",children:e}),t.jsxs("span",{className:"text-xs bg-yellow-100 text-yellow-600 px-2 py-1 rounded-full",children:[s.escalation_rate.toFixed(1),"% escalation"]})]}),t.jsxs("div",{className:"text-sm text-yellow-700",children:[s.total_occurrences," occurrences, ",s.escalated_occurrences," escalated"]})]},a))})]})})]})})}},1466:(e,s,a)=>{"use strict";a.r(s),a.d(s,{$$typeof:()=>l,__esModule:()=>r,default:()=>c});var t=a(5153);let i=(0,t.createProxy)(String.raw`/Users/mandaza/Documents/Project/tavonga/web-app/app/analytics/page.tsx`),{__esModule:r,$$typeof:l}=i,n=i.default,c=n}};var s=require("../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[4312,9708,6897,3223,855,8525,2234,3672,5905,2252],()=>__webpack_exec__(5424));module.exports=a})();