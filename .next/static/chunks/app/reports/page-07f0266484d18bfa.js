(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[882],{2894:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3008:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5817:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},2482:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},6264:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1354:function(e,t,s){Promise.resolve().then(s.bind(s,5580))},5580:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ReportsPage}});var a=s(7437),r=s(2265),i=s(1617),n=s(8230),l=s(2457),c=s(6264),o=s(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,o.Z)("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var h=s(6637),p=s(2482),x=s(5817),m=s(2894),u=s(3008),g=s(6141),v=s(6654),j=s(998),f=s(5750),b=s(105),y=s(1628),N=s(6527),w=s(8823),R=s(3415),C=s(5925);let MonthlyReportChart=e=>{let{behaviors:t,activities:s,shifts:r}=e,i=Array.from({length:6},(e,t)=>{let s=new Date;return s.setMonth(s.getMonth()-t),s.toISOString().slice(0,7)}).reverse(),n=i.map(e=>t.filter(t=>{var s;return null===(s=t.date)||void 0===s?void 0:s.startsWith(e)}).length),c=i.map(e=>s.filter(t=>{var s;return null===(s=t.date)||void 0===s?void 0:s.startsWith(e)}).length),o=i.map(e=>r.filter(t=>{var s;return null===(s=t.date)||void 0===s?void 0:s.startsWith(e)}).length),d={labels:i.map(e=>new Date(e+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"})),datasets:[{label:"Behavior Reports",data:n,backgroundColor:"#FF6B6B",borderColor:"#FF5252",borderWidth:2,borderRadius:4},{label:"Activity Reports",data:c,backgroundColor:"#4ECDC4",borderColor:"#3DB9B2",borderWidth:2,borderRadius:4},{label:"Shift Reports",data:o,backgroundColor:"#45B7D1",borderColor:"#3A9BC7",borderWidth:2,borderRadius:4}]};return(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-card-title",children:"Monthly Report Generation"}),(0,a.jsx)(l.Z,{className:"w-5 h-5 text-nav-icon"})]}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(b.$Q,{data:d,options:{...N.q_,plugins:{...N.q_.plugins,legend:{...N.q_.plugins.legend,position:"top",labels:{...N.q_.plugins.legend.labels,boxWidth:12,padding:15}}},scales:{x:{...N.q_.scales.x,grid:{display:!1}},y:{...N.q_.scales.y,beginAtZero:!0,ticks:{...N.q_.scales.y.ticks,stepSize:5}}}}})})]})},ReportCard=e=>{let{title:t,description:s,icon:r,count:i,trend:n,onGenerate:l,isLoading:o=!1}=e;return(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-btn-primary rounded-lg flex items-center justify-center",children:(0,a.jsx)(r,{className:"w-5 h-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-card-title",children:t}),(0,a.jsx)("p",{className:"text-sm text-card-subtext",children:s})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-card-title",children:i}),n&&(0,a.jsx)("p",{className:"text-sm text-text-positive",children:n})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:l,disabled:o,className:"btn-primary flex items-center gap-2 flex-1",children:[o?(0,a.jsx)(c.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(d,{className:"w-4 h-4"}),o?"Generating...":"Export CSV"]}),(0,a.jsxs)("button",{onClick:l,disabled:o,className:"btn-secondary flex items-center gap-2",children:[o?(0,a.jsx)(c.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(h.Z,{className:"w-4 h-4"}),"PDF"]})]})]})},FilterPanel=e=>{let{dateRange:t,setDateRange:s,selectedCarer:r,setSelectedCarer:i,selectedType:n,setSelectedType:l,users:c}=e;return(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-card-title mb-4",children:"Report Filters"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Date Range"}),(0,a.jsxs)("select",{value:t,onChange:e=>s(e.target.value),className:"input-field",children:[(0,a.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,a.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,a.jsx)("option",{value:"90d",children:"Last 90 days"}),(0,a.jsx)("option",{value:"custom",children:"Custom range"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Carer"}),(0,a.jsxs)("select",{value:r,onChange:e=>i(e.target.value),className:"input-field",children:[(0,a.jsx)("option",{value:"all",children:"All Carers"}),c.map(e=>(0,a.jsx)("option",{value:e.id,children:e.full_name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Report Type"}),(0,a.jsxs)("select",{value:n,onChange:e=>l(e.target.value),className:"input-field",children:[(0,a.jsx)("option",{value:"all",children:"All Types"}),(0,a.jsx)("option",{value:"behavior",children:"Behavior Reports"}),(0,a.jsx)("option",{value:"activity",children:"Activity Reports"}),(0,a.jsx)("option",{value:"shift",children:"Shift Reports"}),(0,a.jsx)("option",{value:"goal",children:"Goal Reports"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-6",children:[(0,a.jsxs)("button",{className:"btn-primary flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),"Apply Filters"]}),(0,a.jsx)("button",{className:"btn-secondary",children:"Reset"})]})]})},RecentReports=()=>(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-card-title",children:"Recent Reports"}),(0,a.jsxs)("button",{className:"btn-secondary flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"}),"Download All"]})]}),(0,a.jsx)("div",{className:"space-y-3",children:[{name:"Behavior Report - Jan 2024",type:"CSV",date:"2024-01-20",size:"2.3 MB"},{name:"Activity Completion Report",type:"PDF",date:"2024-01-19",size:"1.8 MB"},{name:"Shift Attendance Report",type:"CSV",date:"2024-01-18",size:"3.1 MB"},{name:"Goal Progress Report",type:"PDF",date:"2024-01-17",size:"2.7 MB"}].map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-bg-highlight rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:(0,y.cn)("w-8 h-8 rounded-lg flex items-center justify-center","CSV"===e.type?"bg-green-100":"bg-red-100"),children:"CSV"===e.type?(0,a.jsx)(d,{className:"w-4 h-4 text-green-800"}):(0,a.jsx)(h.Z,{className:"w-4 h-4 text-red-800"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-card-title",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-card-subtext",children:[(0,y.p6)(e.date)," â€¢ ",e.size]})]})]}),(0,a.jsx)("button",{className:"p-2 text-nav-icon hover:bg-bg-primary rounded-lg transition-colors",children:(0,a.jsx)(x.Z,{className:"w-4 h-4"})})]},t))})]}),QuickStats=e=>{let{behaviors:t,activities:s,shifts:r,goals:i}=e;return(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-card-subtext",children:"Total Behaviors"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-card-title",children:t.length})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-btn-primary rounded-lg flex items-center justify-center",children:(0,a.jsx)(m.Z,{className:"w-6 h-6 text-white"})})]})}),(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-card-subtext",children:"Completed Activities"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-card-title",children:s.filter(e=>e.completed).length})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-text-positive/10 rounded-lg flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-6 h-6 text-text-positive"})})]})}),(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-card-subtext",children:"Completed Shifts"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-card-title",children:r.filter(e=>"completed"===e.status).length})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(g.Z,{className:"w-6 h-6 text-green-800"})})]})}),(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-card-subtext",children:"Active Goals"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-card-title",children:i.filter(e=>"active"===e.status).length})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(v.Z,{className:"w-6 h-6 text-blue-800"})})]})})]})};function ReportsPage(){let{behaviors:e}=(0,w.SU)(),{activities:t}=(0,w.G$)(),{shifts:s}=(0,w.dE)(),{goals:c}=(0,w.g0)(),{users:o}=(0,w.UV)(),[d,p]=(0,r.useState)("7d"),[x,u]=(0,r.useState)("all"),[b,y]=(0,r.useState)("all"),[N,k]=(0,r.useState)(null),handleGenerateReport=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv";k("".concat(e,"-").concat(t));try{let s,a;let r={format:t};if("all"!==d){let e=new Date,t=new Date;switch(d){case"7d":t.setDate(e.getDate()-7);break;case"30d":t.setDate(e.getDate()-30);break;case"90d":t.setDate(e.getDate()-90)}r.start=t.toISOString().split("T")[0],r.end=e.toISOString().split("T")[0]}switch("all"!==x&&(r.user=x,r.carer=x),e){case"behavior":s=await R.x.generateBehaviorReport(r),a="behavior_report_".concat(new Date().toISOString().split("T")[0],".").concat(t);break;case"activity":s=await R.x.generateActivityReport(r),a="activity_report_".concat(new Date().toISOString().split("T")[0],".").concat(t);break;case"shift":s=await R.x.generateShiftReport(r),a="shift_report_".concat(new Date().toISOString().split("T")[0],".").concat(t);break;case"goal":s=await R.x.generateGoalReport(r),a="goal_report_".concat(new Date().toISOString().split("T")[0],".").concat(t);break;case"carer":case"comprehensive":C.default.error("".concat(e.charAt(0).toUpperCase()+e.slice(1)," reports are coming soon!"));return;default:throw Error("Invalid report type")}let i=window.URL.createObjectURL(s),n=document.createElement("a");n.href=i,n.download=a,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(i),document.body.removeChild(n),C.default.success("".concat(e.charAt(0).toUpperCase()+e.slice(1)," report downloaded successfully!"))}catch(e){console.error("Error generating report:",e),C.default.error(e.message||"Failed to generate report")}finally{k(null)}},getReportCount=a=>{switch(a){case"behavior":return e.length;case"activity":return t.length;case"shift":return s.length;case"goal":return c.length;default:return 0}},getTrend=a=>{let r=new Date,i=new Date;i.setDate(r.getDate()-7);let n=0,l=0;switch(a){case"behavior":n=e.filter(e=>new Date(e.date)>=i).length,l=e.length;break;case"activity":n=t.filter(e=>new Date(e.date)>=i).length,l=t.length;break;case"shift":n=s.filter(e=>new Date(e.date)>=i).length,l=s.length;break;case"goal":n=c.filter(e=>new Date(e.created_at)>=i).length,l=c.length}if(0===l)return;let o=Math.round(n/l*100);return"+".concat(n," this week (").concat(o,"%)")};return(0,a.jsx)(i.Z,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(n.Z,{items:[{label:"Dashboard",href:"/dashboard"},{label:"Reports"}]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:"Reports & Analytics"}),(0,a.jsx)("p",{className:"text-text-secondary",children:"Generate and export comprehensive reports for care management"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("button",{className:"btn-secondary flex items-center gap-2",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4"}),"View Analytics"]}),(0,a.jsxs)("button",{className:"btn-primary flex items-center gap-2",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4"}),"Generate Report"]})]})]}),(0,a.jsx)(QuickStats,{behaviors:e,activities:t,shifts:s,goals:c}),(0,a.jsx)(FilterPanel,{dateRange:d,setDateRange:p,selectedCarer:x,setSelectedCarer:u,selectedType:b,setSelectedType:y,users:o}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,a.jsx)(ReportCard,{title:"Behavior Reports",description:"Track behavior patterns and interventions",icon:m.Z,count:getReportCount("behavior"),trend:getTrend("behavior"),onGenerate:()=>handleGenerateReport("behavior"),isLoading:"behavior-csv"===N}),(0,a.jsx)(ReportCard,{title:"Activity Reports",description:"Monitor activity completion and progress",icon:j.Z,count:getReportCount("activity"),trend:getTrend("activity"),onGenerate:()=>handleGenerateReport("activity"),isLoading:"activity-csv"===N}),(0,a.jsx)(ReportCard,{title:"Shift Reports",description:"Track carer attendance and performance",icon:g.Z,count:getReportCount("shift"),trend:getTrend("shift"),onGenerate:()=>handleGenerateReport("shift"),isLoading:"shift-csv"===N}),(0,a.jsx)(ReportCard,{title:"Goal Reports",description:"Track goal achievement and milestones",icon:v.Z,count:getReportCount("goal"),trend:getTrend("goal"),onGenerate:()=>handleGenerateReport("goal"),isLoading:"goal-csv"===N}),(0,a.jsx)(ReportCard,{title:"Carer Reports",description:"Evaluate carer performance and engagement",icon:f.Z,count:o.length,trend:"".concat(o.filter(e=>e.is_active_carer).length," active"),onGenerate:()=>handleGenerateReport("carer"),isLoading:"carer-csv"===N}),(0,a.jsx)(ReportCard,{title:"Comprehensive Report",description:"Complete overview of all metrics",icon:l.Z,count:1,onGenerate:()=>handleGenerateReport("comprehensive"),isLoading:"comprehensive-csv"===N})]}),(0,a.jsx)(RecentReports,{}),(0,a.jsx)(MonthlyReportChart,{behaviors:e,activities:t,shifts:s})]})})}},6527:function(e,t,s){"use strict";s.d(t,{q_:function(){return r}});var a=s(6704);a.kL.register(a.uw,a.f$,a.od,a.jn,a.ZL,a.qi,a.Dx,a.u,a.De,a.Gu);let r={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"#000000",font:{size:12}}},tooltip:{backgroundColor:"#FFFFFF",titleColor:"#000000",bodyColor:"#6D6D6D",borderColor:"#E0E0E0",borderWidth:1,cornerRadius:8,displayColors:!0}},scales:{x:{grid:{color:"#E5E5E5",drawBorder:!1},ticks:{color:"#6D6D6D",font:{size:11}}},y:{grid:{color:"#E5E5E5",drawBorder:!1},ticks:{color:"#6D6D6D",font:{size:11}}}}}}},function(e){e.O(0,[674,186,607,462,149,180,390,971,472,744],function(){return e(e.s=1354)}),_N_E=e.O()}]);